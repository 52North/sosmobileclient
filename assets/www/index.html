<!doctype html>
<html>
  <head>
  	<meta charset="utf-8">
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  	<title>Mobile SensorWebClient</title>
  	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet/less" href="css/mfmobilepages.less">
    <link rel="stylesheet/less" href="css/style.less">
  </head>
  <body>
    <div id="global-modals"></div>
    <div id="temp-modals"></div>

    <div class="app-panel from-left out" id="legend-panel">
      <header role="banner" class="top app-navbar">
        <a class="nav-btn nav-btn-right" href="#view"><i class="icon-remove"></i></a>
        <h1></h1>
      </header>
      <div class="content" id="legend-content"></div>
    </div>

    <div class="app-page from-left in" id="view-page">
      <header role="banner" class="top app-navbar">
        <a class="nav-btn nav-btn-left page-btn" href="#legend" ><i class="icon-th-list"></i></a>
        <h1><i class="icon-bar-chart"></i> Data View</h1>
        <a class="nav-btn nav-btn-right page-btn" href="#add"><i class="icon-plus"></i></a>
      </header>
      <div class="content" id="view-content">
      </div>
    </div>

    <div class="app-page from-right out" id="add-page">
       <header role="banner" class="top app-navbar">
        <a class="nav-btn nav-btn-left page-btn" href="#view"><i class="icon-bar-chart"></i></a>
        <h1><i class="icon-plus"></i> Add</h1>
        <a class="nav-btn nav-btn-right page-btn" href="#settings"><i class="icon-cogs"></i></a>
      </header>
      <div id="add-content" class="content" ></div>
    </div>

    <div class="app-panel from-right out" id="settings-panel">
      <header role="banner" class="top app-navbar">
        <a class="nav-btn nav-btn-left" href="#add"><i class="icon-remove"></i></a>
        <h1></h1>
      </header>
      <div class="content" id="settings-content">
      </div>
    </div>

    <!-- 3. Party -->
    <script src="js/libs/jquery-1.7.2.min.js"></script>
    <script src="js/libs/jquery-migrate-1.2.1.js"></script>
    <script src="js/libs/underscore.js"></script>
    <script src="js/libs/backbone-1.0.0.js"></script>
    <script src="js/libs/jquery.geo-1.0b1.min.js"></script>
    <script src="js/libs/less-1.3.3.min.js"></script>
    <script src="js/libs/jquery.total-storage.js"></script>
    <script src="js/libs/mfmobilepages.js"></script>
    <script src="js/libs/handlebars-1.0.0.js"></script>
    <script src="js/libs/backbone-mediator.js"></script>

    <!-- Highcharts -->
    <script src="js/libs/highcharts/highcharts.js"></script>
    <script src="js/libs/highcharts/modules/exporting.js"></script>

    <!-- Helpers -->
    <script src="js/helpers/handlebars-helper.js"></script>
    <script src="js/helpers/util.js"></script>
    
    <!-- Phonegap -->
    <script src="js/libs/phonegap/cordova-1.9.0.js"></script>
    <script src="js/libs/phonegap/apis/geolocation.js"></script>

    <!-- Bootstrap -->
    <script src="js/libs/bootstrap.js"></script>

    <!-- Router -->
    <script src="js/router.js"></script>

    <!-- Models -->
    <script src="js/models/service.js"></script>
    <script src="js/models/station.js"></script>
    <script src="js/models/current_settings.js"></script>
    <script src="js/models/timeseries.js"></script>
    
    <!-- Collections -->
    <script src="js/collections/services.js"></script>
    <script src="js/collections/stations.js"></script>
    <script src="js/collections/current_timeseries.js"></script>

    <!-- Views -->
    <script src="js/views/add.js"></script>
    <script src="js/views/browser.js"></script>
    <script src="js/views/map.js"></script>
    <script src="js/views/data.js"></script>
    <script src="js/views/settings.js"></script>
    <script src="js/views/legend.js"></script>
    <script src="js/views/stationsView.js"></script>

    <script>
      $(function() {
        //models and collections
        stations = new Stations();
        currentSettings = new CurrentSettings();
        services = new Services();
        currentTimeseries = new CurrentTimeseries();

        //views
        new SettingsView({'model': currentSettings, 'currentStations': stations, 'availableServices': services}).render();
        new DataView().render();
        new AddView({'stations': stations, 'currentSettings': currentSettings}).render();
        new LegendView({'collection': currentTimeseries}).render();

        //fetching data
        currentTimeseries.fetch();
        currentSettings.fetch();
        stations.url = generateStationsUrl(currentSettings.get('currentProvider'));
        stations.fetch({reset: true});
        services.fetch();
        
        //router
        router = new AppRouter();
        Backbone.history.start();
      });
    </script>

    </body>
</html>